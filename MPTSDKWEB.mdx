---
title: "MPT SDK WEB Documentation"
description: "MPT SDK cho React (CSR), Vue (CSR) v√† JavaScript thu·∫ßn v·ªõi h·ªó tr·ª£ ƒë·∫ßy ƒë·ªß cho cu·ªôc g·ªçi audio/video"
---

# MPT SDK WEB Documentation

## üì¶ C√†i ƒë·∫∑t

```
npm install @mptransformation/omisdk
# ho·∫∑c
yarn add @mptransformation/omisdk
```

## ‚ú® T√≠nh nƒÉng ch√≠nh

- ‚úÖ **SIP Registration**: ƒêƒÉng k√Ω v·ªõi SIP server
- ‚úÖ **Call Management**: Th·ª±c hi·ªán/nh·∫≠n cu·ªôc g·ªçi audio/video
- ‚úÖ **Call Controls**: Hold, mute, DTMF, end call
- ‚úÖ **TypeScript Support**: Full type safety
- ‚úÖ **Event System**: Comprehensive event handling

## üöÄ H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng

### 1. Chu·∫©n b·ªã HTML

T·∫°o c√°c element c·∫ßn thi·∫øt trong file `index.html`:

```
<!-- Element ch·ª©a UI bubble -->
<div id="call-manager"></div>

<!-- Audio elements -->
<audio id="audio1"></audio>
<audio id="audio2"></audio>
<audio id="audio3"></audio>
<audio id="audio4"></audio>
<audio id="audio5"></audio>
<audio id="audio6"></audio>
<audio id="audio7"></audio>

<!-- Video elements -->
<div>
  <video id="local" title="local video" muted></video>
  <video id="video1" title="1" muted></video>
  <video id="screen" title="screen" muted></video>
  <video id="video2" title="2" muted></video>
  <video id="video3" title="3" muted></video>
  <video id="video4" title="4" muted></video>
  <video id="video5" title="5" muted></video>
  <video id="video6" title="6" muted></video>
  <video id="video7" title="7" muted></video>
</div>
```

### 2. T·∫°o custom SDK

T·∫°o file `custom_sdk.ts` k·∫ø th·ª´a t·ª´ OmiSDK:

```
import { OmiSDK } from '@mptransformation/omisdk';

// C·∫•u h√¨nh video v√† audio IDs
const remoteVideoIds = [
    "video1", "video2", "video3", 
    "video4", "video5", "video6"
];

const remoteAudios = [
    "audio1", "audio2", "audio3", 
    "audio4", "audio5", "audio6"
];

class SDK_MPT extends OmiSDK {}

const sdk = new SDK_MPT();
export default sdk;
```

### 3. Kh·ªüi t·∫°o SDK

```
// Kh·ªüi t·∫°o  init SDK ·ªü t·∫ßng layout
sdk.init({
    targetElementId: "call-manager",
    mode: "none",
    theme: {
        primaryColor: "#4CAF50",
        secondaryColor: "#2196F3",
        borderRadius: "8px",
        bubblePosition: "bottom-right",
    },
    debug: true,
    baseUrl: import.meta.env.BASE_URL, // MPT s·∫Ω cung c·∫•p URL
    localVideoId: "local",
    remoteVideoId: remoteVideoIds,
    remoteAudioId: remoteAudios,
    forceNew: false // true  ph·∫£i login l·∫°i m·ªói l·∫ßn F5 v√† ch·ªâ m·ªü ƒë∆∞·ª£c 1 tab
});
```

### 4. ƒêƒÉng nh·∫≠p

#### ƒêƒÉng nh·∫≠p th√¥ng th∆∞·ªùng:

```
sdk.login({
    tenantId: number,
    username: string,
    password: string,
})
.then(() => {
    console.log("‚úÖ Login th√†nh c√¥ng");
})
.catch(err => {
    console.error("‚ùå Login failed:", err);
});
```

#### ƒêƒÉng nh·∫≠p SSO:

```
sdk.loginSSO({
    ssoToken: string,
    organization: string,
})
.then(() => {
    console.log("‚úÖ SSO Login th√†nh c√¥ng");
})
.catch(err => {
    console.error("‚ùå SSO Login failed:", err);
});
```

### 5. X·ª≠ l√Ω Events

#### App Events:

```
sdk.on('AppEvent', (event: AppEvent) => {
    switch(event.type) {
        case AppEventType.CONNECTED:
            // Hi·ªán giao di·ªán m√†n h√¨nh call
            break;
            
        case AppEventType.TOKEN_EXPIRED:
            // Hi·ªán giao di·ªán ƒëƒÉng nh·∫≠p
            break;
            
        case AppEventType.NETWORK_ERROR:
        case AppEventType.DISCONNECTED:
            // Th√¥ng b√°o m·∫•t m·∫°ng/k·∫øt n·ªëi v√† reload trang
            break;
            
        case AppEventType.AUTO_CONNECT:
            // Hi·ªán overlay loading
            break;
    }
});
```

#### Agent Status Events:

```
sdk.on('AgentStatusEvent', (status: AgentStatusEvent) => {
    // X·ª≠ l√Ω UI khi agent thay ƒë·ªïi tr·∫°ng th√°i
    console.log('Agent status changed:', status);
});
```

#### Call Events:

```
let eventList = [];

sdk.on('CallEvent', (event: CallEvent) => {
    eventList.push(event.type);
    
    // X·ª≠ l√Ω c√°c lo·∫°i event kh√°c nhau
    handleCallEvents(eventList, event);
});

function handleCallEvents(eventList: string[], event: CallEvent) {
    // Cu·ªôc g·ªçi inbound
    if (eventList.includes(CallEventType.CALL_CONNECTED)) {
        // Cu·ªôc g·ªçi ƒë√£ k·∫øt n·ªëi v·ªõi agent
    }
    
    if (eventList.includes(CallEventType.CALL_INCOMING)) {
        // Cu·ªôc g·ªçi ƒë·ªï v√†o - hi·ªán 2 button t·ª´ ch·ªëi/ch·∫•p nh·∫≠n
    }
    
    if (eventList.includes(CallEventType.CALL_ANSWERED)) {
        // Agent ho·∫∑c kh√°ch h√†ng nh·∫•c m√°y - hi·ªán call controls
    }
    
    if (eventList.includes(CallEventType.CALL_REJECTED)) {
        // T·ª´ ch·ªëi cu·ªôc g·ªçi (check sessionID ƒë·ªÉ t·∫Øt UI)
    }
    
    if (eventList.includes(CallEventType.CALL_HANGUP)) {
        // K·∫øt th√∫c cu·ªôc g·ªçi (check sessionID ƒë·ªÉ t·∫Øt UI)
    }
    
    // Transfer events
    if (eventList.includes(CallEventType.CALL_TRANSFER_ACCEPTED)) {
        // Chuy·ªÉn cu·ªôc g·ªçi th√†nh c√¥ng
    }
    
    if (eventList.includes(CallEventType.CALL_TRANSFER_FAILED)) {
        // Tham v·∫•n th·∫•t b·∫°i - g·ªçi refuseTransfer
    }
    
    if (eventList.includes(CallEventType.CALL_TRANSFER_RINGING)) {
        // ƒêang ƒë·ªï chu√¥ng tham v·∫•n
    }
    
    if (eventList.includes(CallEventType.CALL_TRANSFER_ANSWER)) {
        // Tham v·∫•n ƒë√£ nh·∫•c m√°y
    }
    
    // Cu·ªôc g·ªçi outbound
    if (eventList.includes(CallEventType.CALL_CONNECTED) && 
        eventList.includes(CallEventType.CALL_OUTGOING)) {
        // ƒêang ch·ªù kh√°ch h√†ng nh·∫•c m√°y
    }
}
```

### 6. Th·ª±c hi·ªán cu·ªôc g·ªçi

```
const result = await sdk.makeCall(phoneNumber, {
    did: "180037784", // ƒê·∫ßu s·ªë g·ªçi ra
    extraInfo: JSON.stringify({ note: "test call" }) // Th√¥ng tin b·ªï sung
});

if (result.success) {
    console.log('‚úÖ Call initiated with session ID:', result);
}
```

## üìö API Reference

### MPTSDK Class Methods

#### Authentication

- `init(SDKOptions)`: Kh·ªüi t·∫°o SDK
- `login(values: LoginRequest): Promise<SdkResponse>`: ƒêƒÉng nh·∫≠p Call Center
- `logout(values: LoginRequest): Promise<SdkResponse>`: ƒêƒÉng xu·∫•t Call Center
- `loginSSO(values: LoginSSORequest): Promise<SdkResponse>`: ƒêƒÉng nh·∫≠p SSO

#### Call Management

- `makeCall(phoneNumber: string, options: CallOptions): Promise<SdkResponse>`: G·ªçi ra
- `makeCallInternal(destination: string, extraInfo: CallOptions): Promise<SdkResponse>`: G·ªçi n·ªôi b·ªô
- `answerCall(options: CallOptions): Promise<SdkResponse>`: Nh·∫≠n cu·ªôc g·ªçi
- `hangup(): Promise<SdkResponse>`: K·∫øt th√∫c cu·ªôc g·ªçi
- `rejectCall(): Promise<SdkResponse>`: T·ª´ ch·ªëi cu·ªôc g·ªçi

#### Call Controls

- `hold(): Promise<SdkResponse>`: Hold cu·ªôc g·ªçi
- `unhold(): Promise<SdkResponse>`: Unhold cu·ªôc g·ªçi
- `mute(): Promise<SdkResponse>`: T·∫Øt mic
- `unmute(): Promise<SdkResponse>`: B·∫≠t mic
- `cameraOn(): Promise<SdkResponse>`: M·ªü camera
- `cameraOff(): Promise<SdkResponse>`: T·∫Øt camera

#### Transfer & Consultation

- `transfer(destination: string, destinationType: DestinationType, transferType: TransferType)`: Chuy·ªÉn ti·∫øp
- `acceptTransfer()`: Ch·∫•p nh·∫≠n chuy·ªÉn cu·ªôc g·ªçi
- `refuseTransfer()`: Thu h·ªìi cu·ªôc g·ªçi

#### Agent Management

- `getCurrentStatus(): Promise<SdkResponse>`: L·∫•y tr·∫°ng th√°i hi·ªán t·∫°i
- `getAgentStatus(): Promise<SdkResponse>`: L·∫•y danh s√°ch tr·∫°ng th√°i agent
- `changeAgentStatus(reasonCodeId: number): Promise<SdkResponse>`: Thay ƒë·ªïi tr·∫°ng th√°i
- `getAgentQueues(): Promise<SdkResponse>`: L·∫•y danh s√°ch queue c·ªßa agent
- `toggleAgentQueue(queueId: string, enable: boolean): Promise<SdkResponse>`: B·∫≠t/t·∫Øt agent tr√™n queue

#### UI Controls

- `hideBubble()`: ·∫®n UI bubble
- `showBubble()`: Hi·ªán UI bubble

#### Information

- `getInfo(): UserInfo`: L·∫•y th√¥ng tin agent
- `getGroupAgents(): Promise<SdkResponse>`: L·∫•y t·∫•t c·∫£ queue trong h·ªá th·ªëng
- `getAgentByExtension(queueExtension: string): Promise<SdkResponse>`: L·∫•y agent theo queue extension
- `getAgentQueuesById(queueId: string): Promise<SdkResponse>`: L·∫•y agent theo queue ID

## üì° Events Reference

### AppEventType

| Event                     | M√¥ t·∫£                                           |
| :------------------------ | :---------------------------------------------- |
| `READY`                   | SDK ƒë√£ s·∫µn s√†ng, init th√†nh c√¥ng                |
| `LOGGED_IN`               | Login th√†nh c√¥ng (c√≥ th·ªÉ ch∆∞a k·∫øt n·ªëi t·ªïng ƒë√†i) |
| `LOGGED_OUT`              | Logout th√†nh c√¥ng                               |
| `TOKEN_EXPIRED`           | Token h·∫øt h·∫°n ho·∫∑c thi·∫øu th√¥ng tin user         |
| `PERMISSION_DENIED`       | Kh√¥ng ƒë∆∞·ª£c c·∫•p quy·ªÅn mic/camera                 |
| `NETWORK_ERROR`           | M·∫•t m·∫°ng                                        |
| `DISCONNECTED`            | M·∫•t k·∫øt n·ªëi v·ªõi t·ªïng ƒë√†i                        |
| `DISCONNECTED_WEB_SOCKET` | M·∫•t k·∫øt n·ªëi socket                              |
| `CONNECTED_WEB_SOCKET`    | K·∫øt n·ªëi socket th√†nh c√¥ng                       |
| `CONNECTED`               | ƒê√£ k·∫øt n·ªëi t·ªïng ƒë√†i, login, c√≥ th√¥ng tin user   |
| `AUTO_CONNECT`            | SDK ƒëang t·ª± ƒë·ªông login v√† connect               |

### CallEventType

| Event                    | M√¥ t·∫£                                |
| :----------------------- | :----------------------------------- |
| `CALL_CONNECTED`         | Cu·ªôc g·ªçi ƒë√£ k·∫øt n·ªëi                  |
| `CALL_INCOMING`          | Cu·ªôc g·ªçi ƒë·ªï v√†o agent                |
| `CALL_OUTGOING`          | Cu·ªôc g·ªçi ra ƒë√£ k·∫øt n·ªëi, ch·ªù nh·∫•c m√°y |
| `CALL_ANSWERED`          | Agent ho·∫∑c kh√°ch h√†ng nh·∫•c m√°y       |
| `CALL_REJECTED`          | H·ªßy cu·ªôc g·ªçi                         |
| `CALL_HANGUP`            | K·∫øt th√∫c cu·ªôc g·ªçi                    |
| `CALL_HOLD`              | Hold cu·ªôc g·ªçi th√†nh c√¥ng             |
| `CALL_UNHOLD`            | Unhold cu·ªôc g·ªçi th√†nh c√¥ng           |
| `CALL_MUTE`              | T·∫Øt mic th√†nh c√¥ng                   |
| `CALL_UNMUTE`            | B·∫≠t mic th√†nh c√¥ng                   |
| `CALL_REFUSE_TRANSFER`   | Thu h·ªìi cu·ªôc g·ªçi th√†nh c√¥ng          |
| `CALL_TRANSFER_ACCEPTED` | Ch·∫•p nh·∫≠n chuy·ªÉn cu·ªôc g·ªçi th√†nh c√¥ng |
| `CALL_TRANSFER_FAILED`   | Tham v·∫•n th·∫•t b·∫°i                    |
| `CALL_TRANSFER_RINGING`  | Cu·ªôc g·ªçi tham v·∫•n ƒëang ƒë·ªï chu√¥ng     |
| `CALL_TRANSFER_ANSWER`   | Cu·ªôc g·ªçi tham v·∫•n ƒë√£ nh·∫•c m√°y        |

### CallEvent Data Structure

```
{
    applicationId?: string,
    channel: string,
    direction: string,
    extraInfo?: string,
    hangupBy?: string,
    name: string,
    type: CallEventType,
    senderId?: string,
    sessionId: string,
    statusCode?: string
}
```

### AgentStatusEvent Structure

```
{
    agentId: string,
    tenantId: string,
    agentName: string,
    statusName: string,
    changeTime: string,
    reasonCode: string,
    reasonCodeId: number,
}
```

## üìÑ License

This project is licensed under the MIT License - see the [LICENSE](https://mptvn-my.sharepoint.com/personal/hoangnt_mpt_com_vn/_layouts/15/LICENSE) file for details.

Made with ‚ù§Ô∏è by [MPT](https://mpt.com/)